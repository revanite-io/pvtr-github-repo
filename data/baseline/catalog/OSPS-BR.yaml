control-families:
  - id: BR
    title: Build and Release
    description: |
      Build and Release focuses on the processes and
      tools used to compile, package, and distribute the
      project's software. These controls help ensure that the
      project's build and release pipelines are secure,
      consistent, and reliable, reducing the risk of
      vulnerabilities or errors in the software distribution
      process.
    controls:
      - id: OSPS-BR-01
        title: |
          The project's build and release pipelines MUST NOT permit untrusted
          input that allows access to privileged resources.
        objective: |
          Reduce the risk of code injection or other security vulnerabilities in the
          project's build and release pipelines by preventing untrusted input from
          accessing privileged resources.
        guideline-mappings:
          - reference-id: CRA
            entries:
              - reference-id: 1.2f
          - reference-id: SSDF
            entries:
              - reference-id: PO.3.2
              - reference-id: PO.5.2
              - reference-id: PS.1
              - reference-id: PS.2
          - reference-id: CSF
            entries:
              - reference-id: PR.AA-02
          - reference-id: OpenCRE
            entries:
              - reference-id: 486-813
              - reference-id: 124-564
              - reference-id: 357-352
          - reference-id: SLSA
            entries:
              - reference-id: Choose an appropriate build platform
          - reference-id: PSSCRM
            entries:
              - reference-id: P2.3
              - reference-id: P3.2
              - reference-id: P3.5
              - reference-id: E2.4
              - reference-id: E2.5
              - reference-id: D2.2
          - reference-id: PCIDSS
            entries:
              - reference-id: 2.2.1
              - reference-id: 6.4.1
          - reference-id: 800-161
            entries:
              - reference-id: AC-3
              - reference-id: AC-4
              - reference-id: AC-4(21)
              - reference-id: CM-5
              - reference-id: CM-7
              - reference-id: SI-7         
        assessment-requirements:
          - id: OSPS-BR-01.01
            text: |
              When a CI/CD pipeline accepts an input parameter, that parameter MUST
              be sanitized and validated prior to use in the pipeline.
            applicability:
              - maturity-1
              - maturity-2
              - maturity-3
            recommendation: # TODO
          - id: OSPS-BR-01.02
            text: |
              When a CI/CD pipeline uses a branch name in its functionality, that
              name value MUST be sanitized and validated prior to use in the
              pipeline.
            applicability:
              - maturity-1
              - maturity-2
              - maturity-3
            recommendation: # TODO

      - id: OSPS-BR-02
        title: |
          All releases and released software assets MUST be assigned a unique
          version identifier for each release intended to be used by users.
        objective: |
          Ensure that each software asset produced by the project is uniquely
          identified, enabling users to track changes and updates to the project
          over time.
        guideline-mappings:
          - reference-id: BPB
            entries:
              - reference-id: CC-B-5
              - reference-id: CC-B-6
              - reference-id: CC-B-7
          - reference-id: CRA
            entries:
              - reference-id: 1.2f
          - reference-id: SSDF
            entries:
              - reference-id: PO.3.2
              - reference-id: PS.1
              - reference-id: PS.2
              - reference-id: PS.3
          - reference-id: OpenCRE
            entries:
              - reference-id: 486-813
              - reference-id: 124-564
          - reference-id: SLSA
            entries:
              - reference-id: Follow a consistent build process
              - reference-id: Provenance generation- Exists, Authentic
          - reference-id: PSSCRM
            entries:
              - reference-id: G1.4
              - reference-id: E1.2
              - reference-id: E2.1
              - reference-id: E2.6
          - reference-id: PCIDSS
            entries:
              - reference-id: 6.4.3
          - reference-id: UKSSCOP
            entries:
              - reference-id: 3.1
          - reference-id: 800-161
            entries: 
              - reference-id: IA-4
              - reference-id: SA-15
              - reference-id: SI-7
              - reference-id: SR-4          
        assessment-requirements:
          - id: OSPS-BR-02.01
            text: |
              When an official release is created, that release MUST be assigned a
              unique version identifier.
            applicability:
              - maturity-2
              - maturity-3
            recommendation: |
              Assign a unique version identifier to each release produced by the
              project, following a consistent naming convention or numbering scheme.
              Examples include SemVer, CalVer, or git commit id.
          - id: OSPS-BR-02.02
            text: |
              When an official release is created, all assets within that release
              MUST be clearly associated with the release identifier or another
              unique identifier for the asset.
            applicability:
              - maturity-3
            recommendation: |
              Assign a unique version identifier to each software asset produced by
              the project, following a consistent naming convention or numbering
              scheme. Examples include SemVer, CalVer, or git commit id.

      - id: OSPS-BR-03
        title: |
          All official project URIs MUST be delivered using encrypted channels.
        objective: |
          Protect the confidentiality and integrity of project source code during
          development, reducing the risk of eavesdropping or data tampering.
        guideline-mappings:
          - reference-id: BPB
            entries:
              - reference-id: B-B-11
          - reference-id: CRA
            entries:
              - reference-id: 1.2d
              - reference-id: 1.2e
              - reference-id: 1.2f
              - reference-id: 1.2i
              - reference-id: 1.2j
              - reference-id: 1.2k
          - reference-id: SSDF
            entries:
              - reference-id: PO.3.2
              - reference-id: PO.5.2
              - reference-id: PS.1
              - reference-id: PS.2
          - reference-id: OpenCRE
            entries:
              - reference-id: 483-813
              - reference-id: 124-564
              - reference-id: 263-184
          - reference-id: SLSA
            entries:
              - reference-id: Choose an appropriate build platform
          - reference-id: PSSCRM
            entries:
              - reference-id: E1.1
              - reference-id: E2.2
              - reference-id: E2.4
              - reference-id: E2.5
          - reference-id: PCIDSS
            entries:
              - reference-id: 2.2.1
              - reference-id: 2.2.7
              - reference-id: 4.2.1
              - reference-id: 4.2.2
              - reference-id: 6.4.1
              - reference-id: 8.3.2
          - reference-id: UKSSCOP
            entries:
              - reference-id: 3.1
          - reference-id: 800-161
            entries: 
              - reference-id: AC-4
              - reference-id: AC-4(21)          
        assessment-requirements:
          - id: OSPS-BR-03.01
            text: |
              When the project lists a URI as an official project channel, that URI
              MUST be exclusively delivered using encrypted channels.
            applicability:
              - maturity-1
              - maturity-2
              - maturity-3
            recommendation: |
              Configure the project's websites and version control systems to use
              encrypted channels such as SSH or HTTPS for data transmission.
              Ensure all tools and domains referenced in project documentation can
              only be accessed via encrypted channels.
          - id: OSPS-BR-03.02
            text: |
              When the project lists a URI as an official distribution channel,
              that URI MUST be exclusively delivered using encrypted channels.
            applicability:
              - maturity-1
              - maturity-2
              - maturity-3
            recommendation: |
              Configure the project's release pipeline to only fetch data from
              websites, API responses, and other services which use encrypted
              channels such as SSH or HTTPS for data transmission.

      - id: OSPS-BR-04
        title: |
          All releases MUST provide a descriptive log of functional and security
          modifications.
        objective: |
          Provide transparency and accountability for changes made to the project's
          software releases, enabling users to understand the modifications and
          improvements included in each release.
        guideline-mappings:
          - reference-id: BPB
            entries:
              - reference-id: CC-B-8
              - reference-id: CC-B-9
              - reference-id: Q-B-7
              - reference-id: A-B-1
              - reference-id: A-S-1
          - reference-id: CRA
            entries:
              - reference-id: 1.2d
              - reference-id: 1.2f
              - reference-id: 1.2h
              - reference-id: 1.2j
              - reference-id: 1.2l
              - reference-id: 2.5
          - reference-id: SSDF
            entries:
              - reference-id: PS.1
              - reference-id: PS.2
              - reference-id: PS.3
              - reference-id: PW.1.2
          - reference-id: OpenCRE
            entries:
              - reference-id: 483-813
              - reference-id: 068-486
              - reference-id: 124-564
              - reference-id: 757-271
              - reference-id: 347-352
              - reference-id: 263-184
              - reference-id: 208-355
              - reference-id: 745-356
              - reference-id: 732-148
          - reference-id: SLSA
            entries:
              - reference-id: Choose an appropriate build platform
              - reference-id: Follow a consistent build process
              - reference-id: Build platform - Isolation strength - isolated
          - reference-id: PSSCRM
            entries:
              - reference-id: G1.4
              - reference-id: E2.1
              - reference-id: E2.4
              - reference-id: E2.5
              - reference-id: E3.1
              - reference-id: E3.6
          - reference-id: PCIDSS
            entries:
              - reference-id: 6.2.1
              - reference-id: 6.4.1
              - reference-id: 6.5.1
              - reference-id: 6.5.2
              - reference-id: 10.2.2
          - reference-id: UKSSCOP
            entries:
              - reference-id: 3.1
              - reference-id: 3.5
          - reference-id: 800-161
            entries: 
              - reference-id: AU-2
              - reference-id: AU-6
              - reference-id: AU-10
              - reference-id: CM-5
              - reference-id: CM-6
              - reference-id: MA-1
              - reference-id: MA-8
              - reference-id: SI-4
              - reference-id: SI-5          
        assessment-requirements:
          - id: OSPS-BR-04.01
            text: |
              When an official release is created, that release MUST contain
              a descriptive log of functional and security
              modifications.
            applicability:
              - maturity-2
              - maturity-3
            recommendation: |
              Ensure that all releases include a descriptive change log. It is
              recommended to ensure that the change log is human-readable and
              includes details beyond commit messages, such as descriptions of the
              security impact or relevance to different use cases. To ensure
              machine readability, place the content under a markdown header
              such as "## Changelog".

      - id: OSPS-BR-05
        title: |
          All build and release pipelines MUST use standardized tooling where
          available to ingest dependencies at build time.
        objective: |
          Ensure that the project's build and release pipelines use standardized tools
          and processes to manage dependencies, reducing the risk of compatibility
          issues or security vulnerabilities in the software.
        guideline-mappings:
          - reference-id: BPB
            entries:
              - reference-id: Q-B-2
          - reference-id: CRA
            entries:
              - reference-id: 1.2b
              - reference-id: 1.2d
              - reference-id: 1.2f
              - reference-id: 1.2h
              - reference-id: 1.2j
              - reference-id: 2.1
              - reference-id: 2.2
              - reference-id: 2.3
          - reference-id: SSDF
            entries:
              - reference-id: PO.3.2
              - reference-id: PS.1
              - reference-id: PS.2
          - reference-id: OpenCRE
            entries:
              - reference-id: 486-813
              - reference-id: 124-564
              - reference-id: 347-352
              - reference-id: 715-334
          - reference-id: SLSA
            entries:
              - reference-id: Isolation strength - isolated
          - reference-id: PSSCRM
            entries:
              - reference-id: P3.1
              - reference-id: P3.5
              - reference-id: E2.2
              - reference-id: E2.3
              - reference-id: E2.4
              - reference-id: E2.5
          - reference-id: SAMM
            entries:
              - reference-id: Implementation -Secure Build -Build Process Lvl2
          - reference-id: PCIDSS
            entries:
              - reference-id: 6.4.3
          - reference-id: UKSSCOP
            entries:
              - reference-id: 1.1
              - reference-id: 1.2
          - reference-id: 800-161
            entries: 
              - reference-id: AC-4
              - reference-id: CM-2
              - reference-id: CM-7(4)
              - reference-id: CM-7(5)
              - reference-id: RA-5
              - reference-id: SA-15
              - reference-id: SR-3          
        assessment-requirements:
          - id: OSPS-BR-05.01
            text: |
              When a build and release pipeline ingests dependencies, it MUST
              use standardized tooling where available.
            applicability:
              - maturity-2
              - maturity-3
            recommendation: |
              Use a common tooling for your ecosystem, such as package managers or
              dependency management tools to ingest dependencies at build time. This
              may include using a dependency file, lock file, or manifest to specify
              the required dependencies, which are then pulled in by the build
              system.

      - id: OSPS-BR-06
        title: |
          Produce all released software assets with signatures and hashes.
        objective: |
          All released software assets MUST be signed or accounted for in a
          signed manifest including each asset's cryptographic hashes.
        guideline-mappings:
          - reference-id: SSDF
            entries:
              - reference-id: PO.5.2
              - reference-id: PS.2
              - reference-id: PS.2.1
              - reference-id: PW.6.2
          - reference-id: Scorecard
            entries:
              - reference-id: Signed-Releases
          - reference-id: SLSA
            entries:
              - reference-id: Distribute provenance - Exists
          - reference-id: PSSCRM
            entries:
              - reference-id: P1.2
              - reference-id: P3.2
              - reference-id: P3.3
              - reference-id: E2.1
              - reference-id: E2.2
              - reference-id: E2.6
          - reference-id: SAMM
            entries:
              - reference-id: Implementation -Secure Deployment -Deployment Process Lvl3
          - reference-id: PCIDSS
            entries:
              - reference-id: 2.2.1
              - reference-id: 2.2.7
              - reference-id: 3.5.1
              - reference-id: 4.2.1
              - reference-id: 4.2.2
              - reference-id: 6.4.1
              - reference-id: 8.3.2
          - reference-id: UKSSCOP
            entries:
              - reference-id: 3.1
          - reference-id: 800-161
            entries: 
              - reference-id: AU-10
              - reference-id: MP-1
              - reference-id: SA-15
              - reference-id: SI-7
              - reference-id: SI-7(14)          
        assessment-requirements:
          - id: OSPS-BR-06.01
            text: |
              When an official release is created, that release MUST be signed or
              accounted for in a signed manifest including each asset's
              cryptographic hashes.
            applicability:
              - maturity-2
              - maturity-3
            recommendation: |
              Sign all released software assets at build time with a cryptographic
              signature or attestations, such as GPG or PGP signature, Sigstore
              signatures, SLSA provenance, or SLSA VSAs. Include the cryptographic
              hashes of each asset in a signed manifest or metadata file.
